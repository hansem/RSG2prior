function S=initRSG2prior

% return all the directory and miscellaneous information about data set as a structure
% change 'base_directory' to point to the 'RSG2prior' directory (e.g., '/Users/hansem/Documents/RSG2prior')
% dependence: v2struct.m, rgb.m, pplot.mat (in /analysis/util)

%% set up base_directory
% base_directory='/Users/hansem/Dropbox (MIT)/RSG2prior';
base_directory='/Users/hansem/Documents/RSG2prior';

%% H & G
animalNm={'H','G'};nAnimal=length(animalNm);
fnameH={...
    %     'H_RSGprior_20161202';... % only eye; use 003
    'H_RSGprior_20161203';... % no photosync; RSG>overlap>RSG; use 003
    'H_RSGprior_20161204';... % no photosync
    'H_RSGprior_20161205';... % no photosync; no overlap
    'H_RSGprior_20161206';...
    'H_RSGprior_20161207';... % % save data from around 800 trials in 12/7
    'H_RSGprior_20161208';...
    'H_RSGprior_20161210';...
    'H_RSGprior_20161211';...
    'H_RSGprior_20161212';...
    'H_RSGprior_20161214';...
    'H_RSGprior_20161215';...
    'H_RSGprior_20161218';...
    'H_RSGprior_20161219';...
    'H_RSGprior_20161220';...
    'H_RSGprior_20161221';...
    'H_RSGprior_20161222';... % saved as 12/21
    'H_RSGprior_20161223'
    };
fnameG={...
    'G_RSGprior_20170506';...
    'G_RSGprior_20170507';...
    'G_RSGprior_20170508';...
    'G_RSGprior_20170510';... % quite>2nd craniotomy
    'G_RSGprior_20170511';...
    'G_RSGprior_20170512';...
    'G_RSGprior_20170803';...
    'G_RSGprior_20170817';...
    'G_RSGprior_20170818';...
    'G_RSGprior_20170821';...
    'G_RSGprior_20170822';...
    'G_RSGprior_20170823';...
    };
fn={fnameH fnameG};

%% stimulation files/sessions

fnameH_stim={'H_20170326';...
    'H_20170328';... % dPreSet100
    'H_20170328_2';...
    'H_20170408';...
    'H_20170409';...
    'H_20170411';...
    'H_20170412';...
    'H_20170412_2';... % 60microA
    'H_20170413';...
    'H_20170413_2';... % dPreSet100
    'H_20170414';...
    'H_20170414_2';... % dPreSet100
    }; % dPreSet100

fnameG_stim={... % % each session with "_withSim", "_noStim"
    'G_20170609';...
    'G_20170610';...
    'G_20170611';... % outlier in huge decrease in sigma
    'G_20170612';...
    'G_20170612_2';...
    'G_20170613_2';...
    'G_20170615';...
    'G_20170615_2';...
    'G_20170616';...
    'G_20170616_2';
    'G_20170618';
    };%

fns={fnameH_stim fnameG_stim}; % file name stimulation

%% folder set up

psthDir=fullfile(base_directory,'data','neurons','processed_data');
singleTDir='/Users/hansem/Dropbox (MIT)/psthDataHigh/singleTrial/';
behDir=fullfile(base_directory,'data','behavior');

neuDir=fullfile(base_directory,'data','neurons','raw_spike_data');
neuDir2=neuDir;
neuDir3=neuDir;

singleNeuronDir=fullfile(base_directory,'data','neurons','PSTH');
fNeuronDir=singleNeuronDir;

figDir=fullfile(base_directory,'figures');
bootDir=fullfile(base_directory,'data','neurons','processed_data'); % '/Users/hansem/Desktop/bootstrapPSTH_RSG2prior_conditionSpecific/trajKS_prior_supportOnly/'; % '/Volumes/hansem/Desktop/bootstrapPSTH_RSG2prior_conditionSpecific/'; % macmini

%% define D data structure
nPr=2;    prNm={'Short','Long'};
nEH=2;ehNm={'Eye','Hand'};
nTarg=2; targNm={'Right','Left'};
if exist('T'), clear T; end;
nTspp=5; T{1}=linspace(480,800,nTspp); T{2}=linspace(800,1200,nTspp); Tall=[T{1} T{2}]; Tmat=T;
nTs=nTspp;

condNm=cell(nPr*nEH*nEH*nTspp,1);
iCond=1;
for iPr=1:nPr
    for iTs=1:nTspp
        for iEH=1:nEH
            for iTarg=1:nTarg
                condNm{iCond}=[prNm{iPr} num2str(T{iPr}(iTs)) ehNm{iEH} targNm{iTarg}];
                iCond=iCond+1;
            end
        end
    end
end

nSplit=2; splitNm={'bias+','bias-'}; % more/less biased; for ts@prior mean, early/late

%% epoch
epochNm={'fixation','targetOn','periReady','periSet','production','t_s','t_p'};

%% recording
sampFreq=30000;
spUnit='samples in blackrock (needs to be converted double(sp)/30000*1000 to be in msec)'; 

%% sorting quality id
sortQ={'MU','SU'};

%% figure settings
load(fullfile(base_directory,'analysis','utils','pplot.mat')); % tmpCmap

% figure's PaperUnits: 'inches'
optsExpFig.Height=3/2.54; %2.1/2.54; % 2*1.2; % 0.8; % '1.2'; % '2'; % 7;
optsExpFig.Width=3/2.54; %3.15/2.54; % 3.6; % 1.5*1.2*2; % '2.4'; % '4';
Width2=2.34/2.54; % 1.7*2*1.2; %
Width3=2.1/2.54; % 1.3*2*1.2;
optsExpFig.FontSize='6';
optsExpFig.FontMode='fixed';
optsExpFig.Format='eps'; % 'tiff'; % 'pdf'; % 'png';
optsExpFig.LockAxes=1;
optsExpFig.LineMode='scaled';
optsExpFig.LineWidthMin=0.5;
optsExpFig.LineWidthMin=1.2;
optsExpFig.Renderer='painters';

lw=2; % 1;
lw2=1;
msize=4;
msize2= 2;

tmpMarker={'^','v','<','>','o','s','d','h'};

cmapPr=[rgb('FireBrick'); rgb('RoyalBlue'); rgb('DarkGreen')]; %
cmapPr2=[rgb('IndianRed'); rgb('DodgerBlue'); rgb('ForestGreen')]; % for each data set

cmapDepth={rgb('DarkRed') rgb('DarkBlue');...
    rgb('Crimson') rgb('MediumBlue');...
    rgb('Salmon') rgb('LightBlue')};

cmapCelltype={rgb('Purple');rgb('Red');rgb('Blue')};

%% 2018/3/19 adding cell stats
% H, 17 sessions, 34 proble penetrations, 196 single 421 multi > 617 total > 555 in PSTH mat (nTrialExc=5) > 536 in reg.mat (thNT(trial/cond):5, thFR(prSup):1)
% G, 12 sessions, 35 proble penetrations, 260 single 481 multi > 741 total > 717 in PSTH mat (nTrialExc=5) > 636 in reg.mat (thNT:5, thFR:1)
sessDate=cell(nAnimal,1);
for iAnimalTmp=1:length(fn)
    fnTmp=cell2mat(fn{iAnimalTmp});
    sessDate{iAnimalTmp}=str2num(fnTmp(:,(end-5):end)); % '161218'
end

nCell={{... % H, 17 sessions, 34 proble penetrations, 196 single 421 multi > 617 total
    [3 13];... % 161203: 16
    [1 40];... % 161204: 41
    [11 20 ];... % 161205: 31
    [24 27;... % 161206: 83
    21 11];...
    [3 5;...% 161207: 17
    3 6];...
    [1 2;...% 161208: 12
    2 3;...
    1 3];...
    [3 11];...% 161210: 14
    [15 29;...% 161211: 59
    3 0 ;...
    4 8];...
    [0 1 ;...% 161212: 2
    1 0 ];...
    [2 22];...% 161214: 24
    [6 22];...% 161215: 28
    [5 21;...% 161218: 53
    6 21];...
    [7 12;...% 161219: 29
    1 9];...
    [5 10;...% 161220: 40
    7 18];...
    [11 22;...% 161221: 53
    6 14];...
    [13 18;...% 161222: 58
    9 18];...
    [14 18;...% 161223: 57
    8 17]};...
% [a,b]=meanSD(n(:,1))
% avg 6.5 SU +/- 6
% avg 14 MU +/- 9.5

% n=[... % G, 12 sessions, 35 proble penetrations, 260 single 481 multi > 741 total
    {[17 19;... % 17/5/6; 107
    21 15;...
    21 14];...
    [20 14;... % 17/5/7; 97
    14 21;...
    10 18];...
    [1 9;... % 17/5/8
    2 10;...
    5 14];...
    [0 3];... % 17/5/10
    [10 21;... % 17/5/11; 105
    3 14;...
    16 41];... 
    [1 5;... % 17/5/12
    0 7;...
    0 7];...
    [2 10;... % 17/8/3
    4 7;...
    3 5];...
    [4 15;... % 17/8/17
    6 20];...
    [7 18;... % 17/8/18; 76
    11 23;... 
    4 13];...
    [14 16;... % 17/8/21; 81
    11 20;... 
    4 16];...
    [13 11;...% 17/8/22;52
    2 11;... 
    1 14];...
    [12 17;... %17/8/23; 83
    11 24;...
    10 9]}};
    % [a,b]=meanSD(n(:,1))
% avg 7.9 SU +/- 6.5
% avg 14.6 MU +/- 7.2
   
%% reward: max duration, window((tp-ts)/ts=0.015 always)
rew={{...
% %     'H_RSGprior_20161202';... % only eye; use 003
[100];...%     'H_RSGprior_20161203';... % no photosync; RSG>overlap>RSG; use 003
[100];...%     'H_RSGprior_20161204';... % no photosync
[100];...%     'H_RSGprior_20161205';... % no photosync; no overlap
[100];...%     'H_RSGprior_20161206';...
[100];...%     'H_RSGprior_20161207';... % % save data from around 800 trials in 12/7
[100];...%     'H_RSGprior_20161208';... 
%     % 2nd craniotomy @12/9 afterward, [5 3 20]
[100];...%     'H_RSGprior_20161210';...
[100];...%     'H_RSGprior_20161211';...
[100];...%     'H_RSGprior_20161212';...
% %     'H_RSGprior_20161213';... % data transfer speed warning issue in 12/13? two cells in NS3 data
[80];...%     'H_RSGprior_20161214';...
[80];...%     'H_RSGprior_20161215';... 
%     % 3rd craniotomy @12/16
[90];...%     'H_RSGprior_20161218';...
[80];...%     'H_RSGprior_20161219';...
[90];...%     'H_RSGprior_20161220';...
[90];...%     'H_RSGprior_20161221';...
[90];...%     'H_RSGprior_20161222';... % saved as 12/21
[90];...%     'H_RSGprior_20161223'
%     };...
%     {...
[70];...%     'G_RSGprior_20170506';...
[75];...%     'G_RSGprior_20170507';...
[80];...%     'G_RSGprior_20170508';...
[80];...%     'G_RSGprior_20170510';... % quite>2nd craniotomy
[80];...%     'G_RSGprior_20170511';...
[80];...%     'G_RSGprior_20170512';...
%     
[80];...%     'G_RSGprior_20170803';...
% 
[80];...%     'G_RSGprior_20170817';...
[80];...%     'G_RSGprior_20170818';...
[80];...%     'G_RSGprior_20170821';...
[80];...%     'G_RSGprior_20170822';...
[80];...%     'G_RSGprior_20170823';...
    }};

%% block structure info: [min mean max]
blockStruct={{...
% %     'H_RSGprior_20161202';... % only eye; use 003
[10 3 25];...%     'H_RSGprior_20161203';... % no photosync; RSG>overlap>RSG; use 003
[10 3 25];...%     'H_RSGprior_20161204';... % no photosync
[10 3 25];...%     'H_RSGprior_20161205';... % no photosync; no overlap
[1 1 1];...%     'H_RSGprior_20161206';...
[1 1 1];...%     'H_RSGprior_20161207';... % % save data from around 800 trials in 12/7
[10 3 25];...%     'H_RSGprior_20161208';... 
%     % 2nd craniotomy @12/9 afterward, [5 3 20]
[5 3 20];...%     'H_RSGprior_20161210';...
[5 3 20];...%     'H_RSGprior_20161211';...
[5 3 20];...%     'H_RSGprior_20161212';...
% %     'H_RSGprior_20161213';... % data transfer speed warning issue in 12/13? two cells in NS3 data
[5 3 20];...%     'H_RSGprior_20161214';...
[5 3 20];...%     'H_RSGprior_20161215';... 
%     % 3rd craniotomy @12/16
[5 3 20];...%     'H_RSGprior_20161218';...
[5 3 20];...%     'H_RSGprior_20161219';...
[5 3 20];...%     'H_RSGprior_20161220';...
[5 3 20];...%     'H_RSGprior_20161221';...
[5 3 20];...%     'H_RSGprior_20161222';... % saved as 12/21
[5 3 20];...%     'H_RSGprior_20161223'
%     };...
%     {...
[10 3 25];...%     'G_RSGprior_20170506';...
[10 3 25];...%     'G_RSGprior_20170507';...
[10 3 25];...%     'G_RSGprior_20170508';...
[10 3 25];...%     'G_RSGprior_20170510';... % quite>2nd craniotomy
[10 3 25];...%     'G_RSGprior_20170511';...
[10 3 25];...%     'G_RSGprior_20170512';...
%     
[10 3 25];...%     'G_RSGprior_20170803';...
% 
[10 3 25];...%     'G_RSGprior_20170817';...
[10 3 25];...%     'G_RSGprior_20170818';...
[10 3 25];...%     'G_RSGprior_20170821';...
[10 3 25];...%     'G_RSGprior_20170822';...
[10 3 25];...%     'G_RSGprior_20170823';...
    }};

% check stat
% a=exprnd(3,100000,1)+5;
% a=a(a<20);
% figure; hist(a,1000);
% [m,s]=meanSD(a)


%% tInfo

tInfoNm={'trial#', 'stageCode', 't(blackRock)[sec]',...
           'idShortTrial(4)', 'idHandEye(5)', 'theta(6)', 'T(7)', 't(8)', 'fixTimeDur(9)', 'targetTimeDur(10)', 'iti(11)', 'reward(12)'};
stageCodeNm={'1. Fix On',...
'2. Fix',... % photodiode sync
'3. target On',... % photodiode sync
'4. Ready',... % photodiode sync
'5. Set',... % photodiode sync
'6. Production',... 
'7. target acquired',... 
'8. reward delay',... % photodiode sync
'9. reward: bonusRewDur*1000+rewardDur*1000*max(0.00001,1-abs(productionInterval - interval)/interval/win_fraction )',... % photodiode sync
'10. trial end',...
'0. ITI',...
'8. incorrect',...
'0. Bad'};

% tInfo: trial#, stageCode, t(blackRock), 
%           idShortTrial(4), idHandEye(5), theta(6), T(7), t(8), fixTimeDur(9), targetTimeDur(10), iti(11), reward(12)]

%% output
S=v2struct;


%%
variables=whos;
for i=1:length(variables)
    assignin('caller',variables(i).name,eval(variables(i).name));
end
